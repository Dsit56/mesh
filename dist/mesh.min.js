Mesh.Browser={init:function(){this.browser=this.searchString(this.dataBrowser)||"Unknown",this.version=this.searchVersion(navigator.userAgent)||this.searchVersion(navigator.appVersion)||0,this.OS=this.searchString(this.dataOS)||"Unknown"},searchString:function(a){for(var b=0;b<a.length;b++){var c=a[b].string,d=a[b].prop;if(this.versionSearchString=a[b].versionSearch||a[b].identity,c){if(-1!=c.indexOf(a[b].subString))return a[b].identity}else if(d)return a[b].identity}},searchVersion:function(a){var b=a.indexOf(this.versionSearchString);if(-1!=b)return parseFloat(a.substring(b+this.versionSearchString.length+1))},dataBrowser:[{string:navigator.userAgent,subString:"Chrome",identity:"Chrome"},{string:navigator.userAgent,subString:"OmniWeb",versionSearch:"OmniWeb/",identity:"OmniWeb"},{string:navigator.vendor,subString:"Apple",identity:"Safari",versionSearch:"Version"},{prop:window.opera,identity:"Opera",versionSearch:"Version"},{string:navigator.vendor,subString:"iCab",identity:"iCab"},{string:navigator.vendor,subString:"KDE",identity:"Konqueror"},{string:navigator.userAgent,subString:"Firefox",identity:"Firefox"},{string:navigator.vendor,subString:"Camino",identity:"Camino"},{string:navigator.userAgent,subString:"Netscape",identity:"Netscape"},{string:navigator.userAgent,subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"},{string:navigator.userAgent,subString:"Gecko",identity:"Mozilla",versionSearch:"rv"},{string:navigator.userAgent,subString:"Mozilla",identity:"Netscape",versionSearch:"Mozilla"}],dataOS:[{string:navigator.platform,subString:"Win",identity:"Windows"},{string:navigator.platform,subString:"Mac",identity:"Mac"},{string:navigator.platform,subString:"iPhone",identity:"iPhone/iPod"},{string:navigator.platform,subString:"iPad",identity:"iPad"},{string:navigator.platform,subString:"Linux",identity:"Linux"}]},Mesh.Browser.Classify={init:function(){Mesh.Browser.browser||Mesh.Browser.init();var a,b=Mesh.Browser.browser.toLowerCase();switch(b){case"explorer":switch(b="ie",Mesh.Browser.version){case 12:case 11:case 10:a="lte10";break;case 9:a="lte10 lte9";break;case 8:a="lte10 lte9 lte8";break;case 7:a="lte10 lte9 lte8 lte7";break;default:a="lte10 lte9 lte8 lte7 lte6"}break;case"firefox":b="ff"}classes=b+" "+b+Mesh.Browser.version,a&&(classes+=" "+a),Mesh.Util.addClass(document.body,classes)}},Mesh.Class=function(){},Mesh.Class.extend=function(a){var b=function(){this.init&&this.init.apply(this,arguments),this._initHooks&&this.callInitHooks()},c=function(){};c.prototype=this.prototype;var d=new c;d.constructor=b,b.prototype=d;for(var e in this)this.hasOwnProperty(e)&&"prototype"!==e&&(b[e]=this[e]);a.statics&&(Mesh.extend(b,a.statics),delete a.statics),a.includes&&(Mesh.Util.extend.apply(null,[d].concat(a.includes)),delete a.includes),a.options&&d.options&&(a.options=Mesh.extend({},d.options,a.options)),Mesh.extend(d,a),d._initHooks=[];var f=this;return d.callInitHooks=function(){if(!this._initHooksCalled){f.prototype.callInitHooks&&f.prototype.callInitHooks.call(this),this._initHooksCalled=!0;for(var a=0,b=d._initHooks.length;b>a;a++)d._initHooks[a].call(this)}},b},Mesh.Class.include=function(a){Mesh.extend(this.prototype,a)},Mesh.Class.mergeOptions=function(a){Mesh.extend(this.prototype.options,a)},Mesh.Class.addInitHook=function(a){var b=Array.prototype.slice.call(arguments,1),c="function"==typeof a?a:function(){this[a].apply(this,b)};this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(c)},Mesh.Mixin={},Mesh.Mixin.Events={addEvent:function(a,b,c){return"undefined"==typeof this.delegates&&(this.delegates={}),"undefined"==typeof this.delegates[a]&&(this.delegates[a]=[]),"undefined"!=typeof b&&b.constructor===Function&&this.delegates[a].push({fn:b,context:c||this}),this},hasEvent:function(a){return"undefined"!=typeof this.delegates&&"undefined"!=typeof this.delegates[a]&&this.delegates[a].length>0},removeEvent:function(a,b,c){if(this.hasEvent(a))for(var d=0;d<this.delegates[a].length;d++)b&&this.delegates[a][d].fn!==b||c&&this.delegates[a][d].context!==c||this.delegates[a].splice(d,1);return this},triggerEvent:function(a){if(this.hasEvent(a)&&"undefined"!=typeof this.delegates[a])for(var b=0;b<this.delegates[a].length;b++)this.delegates[a][b].fn.apply(this,Array.prototype.slice.call(arguments,1));return this}},Mesh.Mixin.Events.on=Mesh.Mixin.Events.addEvent,Mesh.Mixin.Events.off=Mesh.Mixin.Events.removeEvent,Mesh.Mixin.Events.trigger=Mesh.Mixin.Events.triggerEvent,Mesh.Cookies={path:"/",domain:null,set:function(a,b,c,d,e,f){var g=a+"="+escape(b)+"; ";if(c){var h=new Date;h.setTime(h.getTime()+864e5*c);var i=h.toGMTString();g+="expires="+i+"; "}e="string"==typeof e?e:this.path,g+="path="+e+"; ",(f||this.domain)&&(f="string"==typeof f?f:this.domain,g+="domain="+f+"; "),d&&(g+="secure; "),console.log("Set Cookie:",g,b),document.cookie=g},get:function(a){for(var b=a+"=",c=document.cookie.split(";"),d=0;d<c.length;d++){for(var e=c[d];" "==e.charAt(0);)e=e.substring(1,e.length);if(0==e.indexOf(b))return unescape(e.substring(b.length,e.length))}return null},getAll:function(){return document.cookie.split(";")},del:function(a){this.set(a,"",-1)},clearAll:function(){for(var a=document.cookie.split(";"),b=0;b<a.length;b++){var c=a[b],d=c.indexOf("="),e=d>-1?c.substr(0,d):c;this.del(e)}},delMatching:function(a){for(var b=document.cookie.split(";"),c=0;c<b.length;c++){var d=b[c],e=d.indexOf("="),f=e>-1?d.substr(0,e):d,g=f.match(a);g&&g.length&&this.del(f)}}},Mesh.support.formValidation=function(){var a=document.createElement("input");return Mesh.Util.isHostMethod(a,"validity")&&Mesh.Util.isHostMethod(a,"checkValidity")}(),Mesh.support.placeholder=function(){return Mesh.Util.testAttribute("input","placeholder")}(),Mesh.support.autofocus=function(){return Mesh.Util.testAttribute("input","autofocus")}(),Mesh.loaders.validation=function(){for(var a=[],b=document.getElementsByTagName("form"),c=0;c<b.length;c++)Mesh.Util.hasClass(b[c],"validate")&&a.push(b[c]);a.length&&Mesh.forms.validation.setup(a)},Mesh.loaders.autofocus=function(){if(!Mesh.support.autofocus)for(var a=document.getElementsByTagName("form"),b=0;b<a.length;b++)for(var c=a[b].elements,d=0;d<c.length;d++)c[d].hasAttribute("autofocus")&&c[d].focus()},Mesh.forms=Mesh.forms||{},Mesh.forms.forceValidation=!1,Mesh.forms.validation=function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r=/^[a-zA-Z0-9.!#$%&'*+-\/=?\^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/,s=/[a-z][\-\.+a-z]*:\/\//i,t=/^(input|select|textarea)$/i;return f=function(a,b){var c=!a.nodeType||!1,d={validClass:"valid",invalidClass:"error",requiredClass:"required",placeholderClass:"placeholder"};if("object"==typeof b)for(var f in d)"undefined"==typeof b[f]&&(b[f]=d[f]);if(e=b||d,c)for(var h=0,i=a.length;i>h;h++)g(a[h]);else g(a)},g=function(c){var d,e=c.elements,f=e.length,g=!!c.attributes.novalidate;if(Mesh.bind(c,"invalid",i,!0),Mesh.bind(c,"blur",i,!0),Mesh.bind(c,"input",i,!0),Mesh.bind(c,"keyup",i,!0),Mesh.bind(c,"focus",i,!0),Mesh.bind(c,"change",i,!0),Mesh.bind(c,"click",j,!0),Mesh.bind(c,"submit",function(d){a=!0,b||g||c.checkValidity()||Mesh.Util.preventActions(d)},!1),!Mesh.support.formValidation||Mesh.forms.forceValidation)for("undefined"==typeof elem.checkValidity&&(c.checkValidity=function(){return k(c)});f--;)d=!!e[f].attributes.required,"fieldset"!==e[f].nodeName.toLowerCase()&&h(e[f])},h=function(a){var b=a,c=q(b),e={type:b.getAttribute("type"),pattern:b.getAttribute("pattern"),placeholder:b.getAttribute("placeholder")},f=/^(email|url)$/i,g=/^(input|keyup)$/i,h=f.test(e.type)?e.type:e.pattern?e.pattern:!1,i=m(b,h),j=o(b,"step"),p=o(b,"min"),r=o(b,"max"),s=!(""===b.validationMessage||void 0===b.validationMessage);"undefined"==typeof b.checkValidity&&(b.checkValidity=function(){return k.call(this,b)}),"undefined"==typeof b.checkValidity&&(b.setCustomValidity=function(a){l.call(b,a)}),b.validity={valueMissing:c,patternMismatch:i,rangeUnderflow:p,rangeOverflow:r,stepMismatch:j,customError:s,valid:!(c||i||j||p||r||s)},e.placeholder&&!g.test(d)&&n(b)},i=function(a){var b=Mesh.Util.getTarget(a)||a,c=/^(keyup|focusin|focus|change)$/i,f=/^(submit|image|button|reset)$/i,g=/^(checkbox|radio)$/i,j=!0;!t.test(b.nodeName)||f.test(b.type)||f.test(b.nodeName)||(d=a.type,(!Mesh.support.formValidation||Mesh.forms.forceValidation)&&h(b),b.validity.valid&&(""!==b.value||g.test(b.type))||b.value!==b.getAttribute("placeholder")&&b.validity.valid?(Mesh.Util.removeClass(b,[e.invalidClass,e.requiredClass]),Mesh.Util.addClass(b,e.validClass)):c.test(d)?b.validity.valueMissing&&Mesh.Util.removeClass(b,[e.requiredClass,e.invalidClass,e.validClass]):b.validity.valueMissing?(Mesh.Util.removeClass(b,[e.invalidClass,e.validClass]),Mesh.Util.addClass(b,e.requiredClass)):b.validity.valid||(Mesh.Util.removeClass(b,[e.validClass,e.requiredClass]),Mesh.Util.addClass(b,e.invalidClass)),"input"===d&&j&&(Mesh.unbind(b.form,"keyup",i,!0),j=!1))},k=function(b){var c,d,e,f,g=!1;if("form"===b.nodeName.toLowerCase()){c=b.elements;for(var h=0,j=c.length;j>h;h++)d=c[h],e=!!d.attributes.required,f=!!d.attributes.pattern,"fieldset"!==d.nodeName.toLowerCase()&&(e||f&&e)&&(i(d),d.validity.valid||g||(a&&d.focus(),g=!0));return!g}return i(b),b.validity.valid},l=function(a){var b=this;b.validationMessage=a},j=function(a){var c=Mesh.Util.getTarget(a);c.attributes.formnovalidate&&"submit"===c.type&&(b=!0)},m=function(a,b){if("email"===b)return!r.test(a.value);if("url"===b)return!s.test(a.value);if(b){var d=a.getAttribute("placeholder"),e=a.value;return c=new RegExp("^(?:"+b+")$"),e===d?!0:""===e?!1:!c.test(a.value)}return!1},n=function(a){var b={placeholder:a.getAttribute("placeholder")},c=/^(focus|focusin|submit)$/i,f=/^(input|textarea)$/i,g=/^password$/i,h=!!Mesh.support.placeholder;h||!f.test(a.nodeName)||g.test(a.type)||(""!==a.value||c.test(d)?a.value===b.placeholder&&c.test(d)&&(a.value="",Mesh.Util.removeClass(a,e.placeholderClass)):(a.value=b.placeholder,Mesh.bind(a.form,"submit",function(){d="submit",n(a)},!0),Mesh.Util.addClass(a,e.placeholderClass)))},o=function(a,b){var c=parseInt(a.getAttribute("min"),10)||0,d=parseInt(a.getAttribute("max"),10)||!1,e=parseInt(a.getAttribute("step"),10)||1,f=parseInt(a.value,10),g=(f-c)%e;return q(a)||isNaN(f)?"number"===a.getAttribute("type")?!0:!1:"step"===b?a.getAttribute("step")?0!==g:!1:"min"===b?a.getAttribute("min")?c>f:!1:"max"===b?a.getAttribute("max")?f>d:!1:void 0},p=function(a){var b=!!a.attributes.required;return b?q(a):!1},q=function(a){var b=a.getAttribute("placeholder"),c=!!a.attributes.required;return!(!c||""!==a.value&&a.value!==b)},{setup:f,checkField:i}}(document),Mesh.support.fullscreen=!1,function(a,b){function c(){var a=b.createEvent("CustomEvent");a.initCustomEvent("fullscreenchange",!0,!1,null),b.dispatchEvent(a)}function d(){var a=b.createEvent("CustomEvent");a.initCustomEvent("fullscreenerror",!0,!1,null),b.dispatchEvent(a)}b.hasOwnProperty("fullscreenEnabled")||(getter=function(){return"webkitIsFullScreen"in b?(Mesh.support.fullscreen=!0,function(){return b.webkitFullscreenEnabled}):"mozFullScreenEnabled"in b?(Mesh.support.fullscreen=!0,function(){return b.mozFullScreenEnabled}):function(){return!1}}(),Object.defineProperty(b,"fullscreenEnabled",{enumerable:!0,configurable:!1,writeable:!1,get:getter})),b.hasOwnProperty("fullscreenElement")||(getter=function(){for(var a=0,c=["webkitCurrentFullScreenElement","webkitFullscreenElement","mozFullScreenElement"];a<c.length;a++)if(c[a]in b)return function(){return b[c[a]]};return function(){return null}}(),Object.defineProperty(b,"fullscreenElement",{enumerable:!0,configurable:!1,writeable:!1,get:getter})),b.addEventListener("webkitfullscreenchange",c,!1),b.addEventListener("mozfullscreenchange",c,!1),b.addEventListener("webkitfullscreenerror",d,!1),b.addEventListener("mozfullscreenerror",d,!1);var e=(a.HTMLElement||a.Element).prototype;e.requestFullScreen||(e.requestFullScreen=function(){return e.webkitRequestFullScreen?function(){this.webkitRequestFullScreen(Element.ALLOW_KEYBOARD_INPUT)}:e.mozRequestFullScreen?function(){this.mozRequestFullScreen()}:function(){}}()),b.cancelFullScreen||(b.cancelFullScreen=function(){return b.webkitCancelFullScreen||b.mozCancelFullScreen||function(){}}())}(window,document),Mesh.support.geolocation=function(){return"undefined"!=navigator.geolocation}(),Mesh.Geo=Mesh.Class.extend({init:function(){this.watchID=0,this.history=[],this.coords=null,this.error=null,this.active=!1,Mesh.support.geolocation||setError(2,"Geo location is not supported by your browser. Please install the latest Chrome, Safari or Firefox browser.")},includes:Mesh.Mixin.Events,startTracking:function(){if(this.active)return void console.log("GeoLocation: Already tracking");var a=this;navigator.geolocation&&(this.watchID&&navigator.geolocation.clearWatch(this.watchID),navigator.geolocation.getCurrentPosition(function(b){a.active=!0,a.onPosition(b),a.watchID=navigator.geolocation.watchPosition(function(b){return a.history.length&&a.history[a.history.length-1].longitude==b.coords.longitude&&a.history[a.history.length-1].latitude==b.coords.latitude?void console.log("GeoLocation: Dropping Duplicate Position"):void a.onPosition(b)})},function(b){console.log("GeoLocation: Error: ",b);var c="";switch(b.code){case b.TIMEOUT:c="Geo location timed out.";break;case b.POSITION_UNAVAILABLE:c="Geo location is currently unavailable.";break;case b.PERMISSION_DENIED:c="Geo location permission denied by the remote party.";break;case b.UNKNOWN_ERROR:c="Geo location is unavailable on this device."}a.setError(b.code,c)}))},startTestTracking:function(a){if(this.active)return void console.log("GeoLocation: Already tracking");console.log("GeoLocation: Start Test Tracking",this),"object"!=typeof a&&(a=[],a.push([-27.470933,153.023502]),a.push([-27.460933,153.013502]),a.push([-27.450933,153.033502]),a.push([-27.440933,153.043502]),a.push([-27.430933,153.053502]));var b=this,c=function(){if(a.length){var c=a.pop();b.coords={latitude:c[0],longitude:c[1],accuracy:0,altitude:0,altitudeAccuracy:0,timestamp:Math.round((new Date).getTime()/1e3)},b.history.push(b.coords),console.log("GeoLocation: Test Tracking Timeout: ",b.coords),b.trigger("coords",b.coords)}else console.log("GeoLocation: Test Tracking Ended"),clearInterval(d)};this.active=!0;var d=setInterval(c,3e3);c()},stopTracking:function(){this.error=null,this.active=!1,this.history=[],navigator.geolocation&&this.watchID&&navigator.geolocation.clearWatch(this.watchID)},onPosition:function(a){if(!this.active)return void console.log("GeoLocation: Skipping Position: ",a,this.active);var b=this;this.position=a,this.coords=b.positionToJSON(a),this.history.push(this.coords),console.log("GeoLocation: Position: ",a,this.coords),b.trigger("position",a),b.trigger("coords",this.coords)},setError:function(a,b){this.error={code:a,message:b},this.trigger("error",this.error)},positionToJSON:function(a){return a?{latitude:a.coords.latitude,longitude:a.coords.longitude,accuracy:a.coords.accuracy,altitude:a.coords.altitude,altitudeAccuracy:a.coords.altitudeAccuracy,timestamp:a.timestamp}:{}},askGoogle:function(a){$.getScript("http://www.google.com/jsapi",function(b,c){"success"==c?a({latitude:google.loader.ClientLocation.latitude,longitude:google.loader.ClientLocation.longitude},null):a(null,{message:"The server is unavailable",code:2})})},getAddress:function(a){if(!this.coords||!this.coords.latitude||!this.coords.longitude)throw"Cannot get country without geolocation";return this.reverseLookup(this.coords.latitude,this.coords.longitude,a)},reverseLookup:function(a,b,c){return $.getJSON("http://nominatim.openstreetmap.org/reverse?format=json&lat="+a+"&lon="+b+"&zoom=18&addressdetails=1").success(function(a){c&&c(a,null)}).error(function(){c&&c(null,{message:"The server is unavailable",code:2})})}}),Mesh.support.cssTables=function(){var a=$("<div>",{css:{display:"table",position:"absolute",visibility:"hidden"}}).appendTo(document.body||document.documentElement),b="table"===a.css("display");return a.remove(),b}(),Mesh.extend("grid",{init:function(){Mesh.grid.refresh(),$(window).resize(function(){Mesh.grid.refresh()})},refresh:function(){if(!Mesh.support.cssTables){var a=$("#container").height();a&&$(".grid .column, .yfill, .ystretch").each(function(){var b=$(this);b.height(0);var c=Math.min(a,b.parent().height());b.siblings().length>0&&b.siblings().each(function(){var a=$(this);c-=a.height()}),b.height(c)})}}}),Mesh.support.pushState=function(){return!(!window.history||!history.pushState)}(),Mesh.support.hashChange=function(){return!!("onhashchange"in window)}(),Mesh.History={api:null,init:function(){this.delegates=[],this.api||(this.api=Mesh.support.pushState?Mesh.History.HTML5:Mesh.support.hashChange?Mesh.History.Hash:Mesh.History.Legacy),this.api.init()},path:window.location.pathname,onChange:function(a){this.delegates.push(a)},triggerChange:function(a,b){if(this.path==a)return void console.log("Mesh.History: Page Change: Skipping:",a);for(var c=0;c<this.delegates.length;c++)console.log("Mesh.History: Page Change: ",a,b),this.delegates[c].constructor==Function&&this.delegates[c].apply(this,arguments)}},Mesh.History.HTML5={name:"HTML5",init:function(){console.log("Mesh.History.HTML5: init");var a=location.href;window.onpopstate=function(b){return console.log("Mesh.History.HTML5: ",document.location,b),location.href==a?(a=null,void console.log("Mesh.History.HTML5: Skip initial popstate")):(a=null,void Mesh.History.triggerChange(Mesh.History.HTML5.path(),b))}},path:function(){return window.location.pathname}},Mesh.History.Hash={name:"Hash",init:function(){console.log("Mesh.History.Hash: init"),window.onhashchange=function(a){var b=Mesh.History.Hash.path();b&&Mesh.History.triggerChange(b,a)}},path:function(){try{return"/"+window.location.href.split("#/",2)[1]}catch(a){}return void 0}},Mesh.History.Legacy={name:"Legacy",init:function(){console.log("Mesh.History.Legacy: init");var a=window.location.hash;window.setInterval(function(){if(window.location.hash!=a){a=window.location.hash;var b=Mesh.History.Hash.path();b&&Mesh.History.triggerChange(b,event)}},100)}};var Mesh={init:function(){var a,b=this.loaders;for(a in b)b.hasOwnProperty(a)&&b[a]()},loaders:{},support:{}};Mesh.Util={extend:function(a){var b,c,d,e,f=Array.prototype.slice.call(arguments,1);for(c=0,d=f.length;d>c;c++){e=f[c]||{};for(b in e)e.hasOwnProperty(b)&&(a[b]=e[b])}return a},log:function(){"undefined"!=typeof console&&console.log(arguments)},isHostMethod:function(a,b){var c=typeof a[b],d=new RegExp("^function|object$","i");return!!(d.test(c)&&a[b]||"unknown"===c)},preventActions:function(a){a=a||window.event,a.stopPropagation&&a.preventDefault?(a.stopPropagation(),a.preventDefault()):(a.cancelBubble=!0,a.returnValue=!1)},getTarget:function(a){return a=a||window.event,a.target||a.srcElement},bind:function(a,b,c,d){Mesh.Util.isHostMethod(window,"addEventListener")?a.addEventListener(b,c,d):Mesh.Util.isHostMethod(window,"attachEvent")&&"undefined"!=typeof window.event&&("blur"==b?b="focusout":"focus"==b&&(b="focusin"),a.attachEvent("on"+b,c))},unbind:function(a,b,c,d){Mesh.Util.isHostMethod(window,"removeEventListener")?a.removeEventListener(b,c,d):Mesh.Util.isHostMethod(window,"detachEvent")&&"undefined"!=typeof window.event&&a.detachEvent("on"+b,c)},addClass:function(a,b){var c;a.className?(c=new RegExp("(^|\\s)"+b+"(\\s|$)"),c.test(a.className)||(a.className+=" "+b)):a.className=b},removeClass:function(a,b){var c,d,e="object"==typeof b?b.length:1,f=e;if(a.className)if(a.className===b)a.className="";else for(;e--;)c=new RegExp("(^|\\s)"+(f>1?b[e]:b)+"(\\s|$)"),d=a.className.match(c),d&&3===d.length&&(a.className=a.className.replace(c,d[1]&&d[2]?" ":""))},testAttribute:function(a,b){var c=document.createElement(a);return b in c},hasClass:function(a,b){var c=!1;if(!a.className)return!1;var d=a.className.split(" ");for(x in d)if(d[x]==b){c=!0;break}return c}},Mesh.extend=Mesh.Util.extend,Mesh.bind=Mesh.Util.bind,Mesh.unbind=Mesh.Util.unbind;